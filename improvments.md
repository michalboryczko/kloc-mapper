The problem is about containment — knowing which method/class a reference is inside.                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                      
  Consider this PHP:                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                      
  class Foo {                          // line 1                                                                                                                                                                                                                                                      
      public function handle() {       // line 2                                                                                                                                                                                                                                                      
          $this->service->process();   // line 3                                                                                                                                                                                                                                                      
          $this->other->call();        // line 4                                                                                                                                                                                                                                                      
      }                                // line 5                                                                                                                                                                                                                                                      
  }                                    // line 6                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                      
  SCIP emits occurrences for each symbol. Before the fix, the definition of handle() had:                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                      
  range: [2, 20, 2, 26]   // just the word "handle" on line 2                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                      
  And the reference to process() had:                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                      
  range: [3, 25, 3, 32]   // the word "process" on line 3                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                      
  The question kloc-mapper needs to answer: "which method contains the call to process()?" To answer that, it needs to know that handle() spans lines 2-5. But with just [2, 20, 2, 26], it only knows about line 2 — it can't tell if line 3 is inside handle() or not.                              
                                                                                                                                                                                                                                                                                                      
  Why not just extend range? Two reasons:                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                      
  1. range is used by IDEs for highlighting. When you "Go to Definition" of handle(), you want the cursor on the identifier handle, not selecting the entire method body.                                                                                                                             
  2. The scip snapshot tool (used in tests) doesn't render annotations for multi-line ranges — my first attempt broke the golden tests.                                                                                                                                                               
                                                                                                                                                                                                                                                                                                      
  The SCIP solution: enclosing_range — a separate field on the same occurrence that gives the full AST node extent:                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                      
  range:           [2, 20, 2, 26]   // identifier "handle" — for highlighting                                                                                                                                                                                                                         
  enclosing_range: [2, 4, 5, 5]     // full method body — for containment                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                      
  Now kloc-mapper can check: is line 3 between lines 2-5? Yes → process() is inside handle(). This is exactly what the SCIP spec designed enclosing_range for.    